# Lab 1: Serverless Machine Learning Systems

An assignment repository for the Lab 1 in the course of Scalable Machine Learning and Deep Learning.

## Task 1: Run the Feature, Training, Online/Batch Inference Pipelines for the Iris Flower Dataset

**Source Code Github:** https://github.com/ID2223KTH/id2223kth.github.io/tree/master/src/serverless-ml-intro

## Task 2: Build a Serverless ML system for the Wine Quality Dataset

We built a pipeline for the [Wine Quality Dataset](https://www.kaggle.com/datasets/rajyellow46/wine-quality) in the same manner as shown above. After analysing the dataset properties, a feature group for model training was created and a reasonably performing model for the prediction of the classes of wine quality was implemented. Finally, we created an interactive UI for queryable wine quality prediction and a dashboard UI showing the synthetic wine data generated by a realistic wine simulation function and the recent prediction history.

### Feature Selection

### Data Preprocessing

### Model Optimisation

### Synthetic Data Generation

## User applications

Hugging Face is used for user-facing applications. The following applications are available for both datasets (Iris and Wine):
- **Interactive UI:** A simple UI for querying the model with custom input.

- **Dashboard UI:** A dashboard for monitoring the model performance and the synthetic data generation. In the case of the Wine dataset, the dashboard displays the most recent wine added and the predicted quality for it, along with the recent history of the predictions, and a confusion matrix for the model's predictions. 


#### Application URLs
- https://huggingface.co/spaces/esnagy/Iris
- https://huggingface.co/spaces/esnagy/iris-dashboard
- https://huggingface.co/spaces/esnagy/wine-quality-prediction
- https://huggingface.co/spaces/esnagy/wine-prediction-dashboard

## Serverless ML pipelines

![Iris as a serverless ML system](./Iris%20as%20a%20serverless%20ML%20system.png)
*Pipeline configuration for the Iris dataset. The same setup is used for the Wine dataset.*

We use GitHub Actions to develop the serverless ML pipelines. For both datasets (Iris and Wine) we deployed the following pipelines:
- Feature pipeline:
    1. Generates new data samples. Uses the provided data generator function for the Iris dataset and the method described in the [Synthetic Data Generation](#synthetic-data-generation) section for the Wine dataset.
    2. Stores them as features in the HopsWorks feature store.
- Batch inference pipeline:
    1. Reads the features from the feature store.
    2. Runs a batch inference job on the features.
    3. Stores the predictions in the feature store.
    4. Creates and stores a confusion matrix and the recent history of the predictions for later monitoring and analysis.

They are scheduled to run daily. The training can be triggered manually.
